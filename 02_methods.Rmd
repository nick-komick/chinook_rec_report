---
output:
  pdf_document: default
  html_document: default
---
\clearpage

# Methods

## Revised Chinook catch estimates (with iREC)

Since the introduction of iREC in 2013, there has been different methods to combining Chinook catch estimates from the survey with creel and log books recreational catch estimates. The primary purpose of revising recreational catch estimates is to incorporate the different sources of catch into a single standardized set of recreational catch estimates for all Pacific Region marine waters.

### Background on survey methods

We first provide a brief background on the regionally-specific creel and logbook programs, coast-wide iREC reporting, and how each contribute to Chinook catch estimates in a given month. More details on each method can be found in some relevant technical reports (@sturhahn2001, @english2002, @korman2005evaluation). We note any improvements to the data quality assurance and control that may have occurred in order to create the data sets used in this analysis. While all methods report on multiple species, here we are concerned only with data involving Chinook salmon. The coastal area of interest is all Pacific Fishery Management Areas (PFMAs, Figure \@ref(fig:fig-PFMA), @pfma_2007), more information and detailed maps can be found on the [DFO website](https://www.pac.dfo-mpo.gc.ca/fm-gp/maps-cartes/areas-secteurs/index-eng.html).

```{r myfigure, echo=FALSE, message=FALSE, warning=FALSE, out.width="70%"}
#| label: fig-PFMA
#| fig-cap: "Pacific Fishery Management Areas"

fig1_path <- "data/PFMA.png"

knitr::include_graphics(c(fig1_path))
```    

#### South Coast Catch Estimation (Kris/Rob to review this section)

South Coast catch estimation is a combination of creel surveys and logbooks from both guides and avid angler programs. The South Coast Creel Survey (SCCS), run by the DFO, began in the early 1980s and was limited to Strait of Georgia recreational fisheries. It has since expanded in scope to survey PFMAs 10 to 27, including offshore areas (those with PFMA IDs in the 100s). The surveys are conducted in the summer months, however some spring and fall surveys occur in specific areas. The survey involves dock-side fisher interviews to capture catch rates and aerial surveys for effort counts. Raw estimates and uncertainty are expanded to cover a given month and area (typically PFMA). Currently, this program estimates the following:

* Sub-legal sized release catch
* Legal sized released catch based on adipose-clip status (e.g clipped/marked and unclipped/unmarked)
* Legal sized kept catch based on adipose-clip status (e.g clipped/marked and unclipped/unmarked)

In the past, kept catch with unknown adipose clip status were split to marked and unmarked using a monthly mark rate and to kept and released using a monthly release rate. For more information and methods about the SCCS, see the most recent program overview and bulletins (e.g @scab2024). While the SCCS is the primary source of data for the South Coast, logbook data from guides and avid angler programs are provided on a voluntary basis and are removed from area and month-specific estimates of the creel survey to avoid double-counting.

##### South Coast Creel Survey quality control

Since the South Coast creel surveys vary in sampling intensity and spatial/temporal coverage, we have introduced a systematic quality control of these estimates. Following the method used for iREC calibration to creel (*cite DFO iREC report - is this already published or is this the first time creel quality control published?*), we filtered the creel data based on quality criteria in a given area and month. These quality control criteria are designed to avoid uncertainty associated with monthly estimate based on only a small number of days or biases when estimates based on only a certain type of day (e.g. weekends). Each area and monthly creel estimate included in our data was required to meet each of the following criteria:

*Note: Kris and Rob to flesh out these bullet points .... Why was at least 3 flights for each type of day chosen? Is that because in a month you typically get x amount of flights? Need to flesh out each bullet point with context.*

- At least 3 flights for each type of day (weekday or weekend)
- At least 25 interviews mid week OR at least 10% of interviews from mid-week
- At least 25 interviews on weekends OR at least 10% of interviews from weekend
- At least 15 day spread in flights
- At least 15 day spread in interviews

The criteria failed 51% of all estimates since 2005 (Figure \@ref(fig:fig-creel-criteria)). PFMA 15 and 16 had the highest proportion of failed criteria, followed by Area 29, 19 (GS) and 21, which all had over 80% of estimates fail the criteria. The core summer months of July and August have the highest rate of criteria passing (more than 70% of estimates passing), whereas the winter months (October through February) have more than 75% failed criteria, likely due to weather making consistent overflights difficult.

\begin{landscapepage}

```{r methods Loading packages useful functions, message=FALSE, warning=FALSE, results='hide', echo=FALSE}

col1 = "#e0ecf4"
col2 = "#0570b0"
col3 = "lightblue"
col4 = "lightblue4"
col5 = "#fddbc7"
col6 = "#cb181d"
col7 = "purple"
col8 = "purple4"
colclear= "#1C00ff00"

```

```{r methods plotting PFMA creel unfiltered, echo=FALSE, message=FALSE, warning=FALSE, fig.height=18, fig.width=15, fig.align="left", out.width="9in"}
#| label: fig-creel-criteria
#| fig-cap: "South Coast creel estimates that passed (green) or failed (red) quality control criteria by month and PFMA."

creel_month_PFMA <- pacRecCatch::filter_creel_catch("pacRecCatch_db.yaml")
Creel_month_PFMA_failed <- 
  creel_month_PFMA  |>
  filter(criteria == "failed") |>
  mutate(across(where(is.numeric), ~na_if(., 0))) |>  
  filter(area %notin% c("3", "4"))


Creel_month_PFMA_passed <- 
  creel_month_PFMA |>
  filter(criteria == "passed") |>
  mutate(across(where(is.numeric), ~na_if(., 0))) |>
  filter(area %notin% c("3", "4"))

ggplot() +
  geom_tile(data=Creel_month_PFMA_passed, aes(x=year, y=as.factor(month), fill = val),colour = "white") +
  scale_fill_gradient(low = col1, high = col2,  na.value = colclear, limits=c(0,20000)) +
  scale_y_discrete(limits=rev)+
  guides(fill=guide_legend(title="Creel estimates that passed criteria")) +
  new_scale_fill() +
  geom_tile(data=Creel_month_PFMA_failed, aes(x=year, y=as.factor(month), fill = val),colour = "white") +
  scale_fill_gradient(low = col5, high = col6,  na.value = colclear, limits=c(0,20000))+
  facet_wrap(~area, ncol = 6)+
  guides(fill=guide_legend(title="Creel estimates that failed criteria")) +
  labs(title = "Coverage by PFMA", x = "Year", y = "Month") +
  theme_minimal() + 
  #making the text bigger
  theme(
    legend.position="bottom",
    strip.text = element_text(size = 12), #facet wrap labels
    plot.title = element_text(size = 18, face = "bold"),
    axis.title.x = element_text(size = 14), # x-axis title
    axis.title.y = element_text(size = 17),  # y-axis title
    legend.text = element_text(size = 13),
    axis.text.y = element_text(size = 8),# make y axis bigger,
    plot.margin = margin(2, 2, 2, 2)
  )

```
\end{landscapepage}


#### Central Coast Catch Estimation - *Chelsea to review/expand this section*

Central Coast catch estimation is exclusively logbook data from lodges. The PFMAs included in central coast are 6, 7, 8, 9, 10 and their outer counterparts 106, 107, 108, 109, 110. This data is typically not by marked and kept status so those distinctions need to be reconstructed using mark rate and release rates.

-   *Do they adjust the catch for like 80% of lodges reported for eg. I.e. is this NOT an expanded estimate?*

-   *What about CCIRA? Note the development of CCIRA but that data not yet available to be incorporated.*

#### North Coast Catch Estimation - *Chelsea and Jessica to review/expand*

The North Coast catch estimation is a combination of independently-run creel programs and logbook data. Northern BC (NBC) Abundance Based Fishery is comprised of PFMAs 1, 2 (East and West), 101, 102, 142. It is a combination of the Haida creel program and lodge-submitted logbooks. NBC ISBM is comprised of the Skeena creel program and logbooks run in PFMAs 3 and 4 (and 103, 104). Technically PFMA 5 and 105 is included in this category but there is no data from Area 5. Data for before 2008 is not available. As in Central coast, typically this data is typically not collected by marked and kept status so those distinctions need to be reconstructed using mark rates and release rates.

-   *North coast description of standalone programs - expand on the Haida creel and the 3/4 creel details, who are they run by, when the programs were started, when are they typically run (time of year).*
-   *description of how creel and logbook are combined*
-   *Do they adjust for % lodges reporting?*
-   *Explain if/where marked and kept status data is collected and since when?*

#### Internet Recreational Catch (iREC) Survey - *Rob/Nick/Catarina to review this section*

*Note: this section could be shorter? We don't need to go into full details?*

The mandatory internet recreational effort and catch (iREC) survey is a recent method for estimating recreational fishing effort and catch in Pacific Region tidal waters. The iREC survey annually provides catch estimates and associated precision across all tidal water Pacific Fishery Management Areas (PFMA's), licenced fishing methods, species and fates (retained or released) at a monthly resolution (Houtman et al, 2015). For all fishing methods besides boat-based angling -- specifically angling from shore, shellfish trapping from boat or shore, beach collecting, hand picking, diving, and other methods -- these are the first estimates available.

Despite this potential bias (*what bias?*), the iREC estimates are currently used, in a relative way, to prioritize the allocation of resources of creel surveys. Creel surveys are funded through contributions from Science (Salmon Stock Assessment) and Fisheries Management branches of Fisheries and Oceans Canada, ostensibly for the estimation of recreational salmon and Halibut catches although estimates for other finfish species are made. The iREC estimates of salmon and halibut catch, along with boat-based recreational angling effort, are used to rank the most important month and area combinations for creel survey allocation purposes. Currently, creel surveys are focused on month -- area combinations contributing the highest combined retained catches of Chinook Salmon and Halibut. In times and locations where fishing effort and catch of these important species are low, creel surveys are not currently conducted (Houtman et al. 2015). In fact, for many month -- PFMA combinations, creel surveys or other recreational monitoring approaches have never been used to estimate recreational fishing effort or catch. 

##### Survey License Selection

When the iREC survey initially began in 2012, survey participants were selected from a provided subset of licence holders that purchased through a web based license purchasing system. This subset excluded any paper-based licences that were issued outside the web-based system and typically consisted of approximately XX% of all recreational licence holders. This subset of licence holders were contacted by email with notification that they had been selected for the survey and provided instructions on how to report their fishing activity.

In more recent years (since 2018??) the iREC survey takes advantage of the web based purchasing of recreational licences to automatically select an licence holder to a survey and communicate what month they are to respond for. Random selections of fishers with licences active in a given month are obligated to provide details about their fishing activity and catch through a web-based survey tool. This fishing information from survey respondents is expanded to estimate total effort and catch following the methods described by Houtman et al. (2015).

The iREC survey is designed to provide month recreational catch estimates for every area within DFO's Pacific Region. When the survey was initially designed, the survey used the legal definition of Pacific Fishery Management Areas (PFMA) within the @pfma_2007.

##### License Stratification

When assessing survey responses, annual licences are unique compared to term licences as they can potentially fish any date after the licence purchase date and may be selected for one of several survey months within the licence year. To improve the representativeness of annual licence holders and provide more consistent precision across months within the year, the iREC licence selection process has used different stratification methods over the years. Over the years, the approach to stratification was adjusted to better align to improvements in the licence selection process and the increased number of selected licenses.

At the beginning of the iREC survey in 2012, licences were selected monthly after the licence was purchased. Selected licences were separated into a pre-selection and a post-selection strata based on whether they were selected for previous month or a future month. As nearly all term licences fish near the licence purchase date, which is before the selection date, they were all stratified as post-selection. However, annual licences may be selected for either the month they purchased in or a future survey month. Selected annual licences that were purchased during the survey month were put into the post-selection strata. If the survey month was for future month, then the licence is stratified as a post-selection strata. For example, if a licence was purchased on August 15th and they were selected for the August survey, the licence was stratified as a post-selection licence. However, if that same licence was selected for the October survey, the licence would be stratified as pre-selection.

Total annual catch estimates of boat-based angling would thus be equal to the sum of estimates from creel surveys for all months and areas where they occurred plus the calibrated iREC (iREC\*) estimates for all months and areas where they did not. Despite the apparent simplicity of this calibration method, there are outstanding issues regarding the use of creel survey estimates to calibrate iREC estimates; three of which we address here. First, creel surveys vary in sampling intensity and spatial and temporal coverage even with a particular month -- area estimate strata. This variability in the 'quality' of creel estimates (both in terms of accuracy and precision) may adversely affect calibration of iREC estimates. Second, variability in the relative strength and direction of "response bias" may influence the spatial or temporal patterns of bias in iREC estimates, with important implications for calibration. Finally, we combine information about the previous two issues to make recommendations about where, when and how to conduct relatively costly creel surveys to maximize their calibration value.

##### iREC to Creel Calibration

The apparent bias in iREC estimates could result from numerous sources. With an invitational fisher-dependent survey of this type, there is potential that the respondents to the survey are not representative of all licenced fishers. Such 'response bias' could result from differential response rates by successful or unsuccessful fishers, active or inactive fishers, people who tend to inaccurately report their catch for prestige or strategic reasons as well as problems with recalling the details of their fishing activity. The survey is designed to minimize bias where possible, but not all sources of bias can be completely addressed through design or education. Without a source of alternative estimates of high accuracy, the overall magnitude and direction of bias is difficult to quantify.

*moved this section back to under the "irec" section*

Where absolute estimates of effort and catch are demanded, such as for allocation decisions, stock assessments and catch reporting requirements, calibration of iREC estimates would be required. Calibrated iREC estimates for boat-based angling would be achieved by scaling iREC to creel estimates using the regression parameters (slope $m$) of iREC -- creel regressions for equivalent month -- area pairs. The calibrated iREC point estimates of boat-based angling effort or species specific catch (iREC\*) would be simply:

$$iREC^*= creel = \frac{(iREC)}{m}$$

The calibration coefficient $m$ is estimated annually using all area and month estimates of creel that are appropriate quality based on the criteria identified in the "South Coast Creel Survey quality control" section of this document.  Separate calibration factors are estimated for total kept and released catch, by species, for angling by boat.  As both the creel and iREC estimates have uncertainty associated with them, an error-in-variables approach is used to estimate $m$ using JAGS (@plummer2003jags) through the `rjags` R package (@rjags). The specific model code used is provided below, with `creel.obs` representing the creel estimate, `creel.se` representing the standard error of the creel estimate, and `iRec.obs` representing the iREC uncalibrated catch estimate for the same area and time as the creel estimate.

```{r methods jags, echo=TRUE}
model.jags <- function() {   
  for(i in 1:Ndata) {      
    #generate what true value may be based on se (notice that dnorm in jags      
    # uses 1/variance for second argument thus 1/SE^2)      
    creel.true[i] ~ dnorm(creel.obs[i], 1/creel.se[i]*1/creel.se[i])            
    #now for the actual regression equation     
    mu[i] <- beta1 * creel.true[i]      
    iRec.obs[i] ~ dnorm(mu[i], tau)   
  }      
  beta1 ~ dnorm(0, 0.0001)   
  tau ~ dgram(0.01, 0.01) 
  #a common prior for a variance term in vertical direction     
  #derived variables   
  sigma <- 1/sqrt(tau) 
  #std deviation about the regression line
}
```

*Notes to add:*

-   *Forced through the origin (need background?)*

### Combining survey methods for best catch estimates

In the past, iREC was incorporated into domestic catch estimation products in various ways, it was an infilling method for South Coast products, and at a high stratification level for the CTC's reporting. Neither of these methods were robust or systematic approaches to incorporating iREC at the finest scale possible. Here, we outline a systematic method for combining survey methods to obtain the best catch estimate in a given month and PFMA.

We pulled raw recreational catch data from DFO's Catch and Release Estimates (CREST) database, which stores creel, logbook, and iREC data for both marine and freshwater regions. The data was filtered to only marine estimates of legal-sized marked and unmarked fish that were kept or released. Northern BC (creel and logbook estimates 2005-2023) and Central BC (logbook only estimates 2022-2023) catch estimates were incomplete in CREST for these regions. We filtered CREST catch data to only south coast creel, as described above, to only include high quality creel estimates. These estimates (which don't include submissions from logbooks) were then augmented with logbook data where available (logbook and creel estimates were summed).

We assembled and combined recreational Chinook catch data by developing the [pacRecCatch](https://github.com/nick-komick/pacRecCatch) R package. This package has several functions to pull data from CREST and load in other sources manually. The package has functions that will then clean, filter, align, and combine the various survey methods to the final dataset as described below.

#### Catch Stratification

*Notes:*

-   *work on the language to simplfy the linkage between finescale and ERA fishery ....*
-  *add reference to CTC reports*

In Appendix \@ref(strattab), we show the stratification of fisheries to PFMAs and months used for catch estimation. In order to provide consolidated recreational catch estimates and to fulfill Treaty obligations to incorporate Mark Selective Fisheries, we recently reorganized the fishery stratification levels used by the CTC. PFMAs are used domestically to collect the data, while finescale and exploitation rate analysis fisheries are groupings of fisheries used for CTC analyses. New Finescale Fisheries are a grouping of PFMAs under a given season, they were introduced recently and are the level at which marked release rates and unmarked release rates are generated. The CTC ERA fisheries are the exploitation rate analysis fisheries and are the level at which CTC reporting happens and exploitation rate calculations happen.

*Notes:*

-   *may want to have detailed description of fisheries - like ERA level BC Juan de Fuca ....*

#### Alignment issues

iREC and creel both operate on the Pacific Fisheries Management Area system. However, there are a few areas that were initially not split by the iREC system into their component parts, as done in the creel database. These include areas 2, 19, 20, and 23. We therefore combined creel data from 2013 until the split was successfully incorporated into iREC (licence year 2014 for Areas 2,19, and 23; licence year 2020 for Area 20).

*Note:*

-   *Add something about ISBM corridor alignment issue and how we handle it -i.e. iREC is just the whole PFMA whereas creel is specific sub-areas*

-   *Kris Hein has a good explanation for the alignment problem (creel surveys aerial need to be not on PFMA boundaries where a lot of people fish) ---- creel sub areas vs. pfma sub-areas*

### Extrapolating unchecked catch by mark rate

All data is typically collected in number of marked and unmarked fish kept and released. However, when mark status is unknown, catch estimates can be provided as unchecked kept and unchecked released catch. We extrapolated these unchecked estimates to marked and unmarked catch using mark rate.

The creel data estimates only started estimating catch by adipose clip status in 2009.  Before 2009, Chinook catch was estimated only for kept and release.  To utilize the mark rate data collected by creel surveys from 2005 to 2008, the sample data were specifically loaded for south coast areas and used to both kept and release catch by mark status for each year, month, and area combination.

We calculated mark rate in a number of different ways and prioritize the assignment of mark rate in the following order:

 1. Monthly area calculation - Mark rate calculated for a given source (iREC, creel, or logbook) within a given year, month, and area
 2. Monthly average by source - Mark rate calculated within a given year, month, and area, averaged across sources
 3. Monthly regional average - Mark rate calculated for a given source within a given year, month, and region (averaged across areas within a region)
 4. Seasonal area average - Mark rate calculated for a given source (iREC, creel, or logbook) within a given year, season, and area
 5. Seasonal regional average -Mark rate calculated for a given source within a given year, season, and region
 6. Monthly area average across years - Mark rate calculated for a given source within a given month, area, and across years
 7. Monthly regional average across years- Mark rate calculated for a given source within a given month, region, and across years

### Choosing best monthly catch estimate per PFMA

We used the following rules to choose the best catch estimate between creel (augmented with logbook data) and calibrated iREC:

For Southern BC:

 - In months May-September (5-9) use creel + logbook if creel passes quality control rules, otherwise use calibrated iREC
 - In months outside of 5-9, use calibrated iREC

For Northern and Central BC:

 - Use calibrated iREC from 2015 onwards

In Southern BC, these rules prioritize quality-controlled creel estimates during the summer months, when most creel survey effort is concentrated, and prioritizes calibrated iREC data during shoulder seasons and anywhere there is a gap in creel coverage. 

Northern and Central BC do not have standardized creel, and therefore the iREC data is preferred over logbook-only data. iREC took longer to achieve effective sample rates in Northern BC and therefore data from 2015 onwards is used.

In Figure \@ref(fig:fig-creel-irec-NGS) we demonstrate how iREC fills in the gaps in each PFMA for a given finescale fishery (North Georgia Strait is shown as an example).

*Note: fix the scale of this plot - consider using an areas that's not JDF and doesn't have the weird 20 split* 
*LG - May 2025 - added colour blind friendly palette, changed to NGS S to avoid the area 20 split, stacked legend so it doesn't get cut off*

\begin{landscapepage}

```{r methods pfma_month again, message=FALSE, warning=FALSE, results='hide', echo=FALSE}

pfma_yearMonth <- 
  sport_catch_area |>
  group_by(year, month, area, region, finescale_fishery) |>
  summarise(sum_creel = sum(creel, na.rm = TRUE), 
            sum = sum(creel_plus, na.rm = TRUE), 
            sum_historic = sum(historic_plus, na.rm = TRUE), 
            sum_catch_estimate = sum(catch_estimate, na.rm = TRUE), 
            sum_irec = sum(irec_calibrated, na.rm = TRUE),
            .groups = "drop") |>
  mutate(across(where(is.double), ~na_if(., 0)))

pfma_yearMonth_catch_estimate_1 <- 
  pfma_yearMonth  |>
  filter(sum_catch_estimate != sum, 
         sum_catch_estimate != sum_historic, 
         sum_catch_estimate != sum_irec)

pfma_yearMonth_irec_1 <-
  pfma_yearMonth |> 
  filter(sum_catch_estimate == sum_irec)
```


```{r methods plotting PFMA - Northern Strait of Georgia, echo=FALSE, message=FALSE, warning=FALSE, fig.height=18, fig.width=15, fig.align="left", out.width="9in"}
#| label: fig-creel-irec-NGS
#| fig-cap: "Creel estimates in Northern Strait of Georgia by area and month and chosen best catch estimate between creel and iREC"

ngs_catch <-
  pfma_yearMonth |>
  filter(region == "NGS")

ngs_irec_catch <-
  pfma_yearMonth_irec_1|>
  filter(region == "NGS")

#ordering by spring, summer, fall for graph
ngs_catch$finescale_fishery <- factor(
  ngs_catch$finescale_fishery,
  levels = c("NGS S SPRING", "NGS S SUMMER", "NGS S FALL")
)

g <-
  ggplot()+
  geom_tile(data = ngs_catch, 
            aes(x=year, y=as.factor(month), fill = sum_catch_estimate), 
            colour = "white") +
  scale_fill_gradient(low = col1, high = col2,  na.value = colclear, limits=c(0,20000)) +
  scale_y_discrete(limits = rev)+
  guides(fill=guide_legend(title="Creel or logbook estimates")) +
  new_scale_fill() +
  geom_tile(data = ngs_irec_catch, 
            aes(x=year, y=as.factor(month), fill = sum_catch_estimate), 
            colour = "white") +
  scale_fill_gradient(low = col5, high = col6,  na.value = colclear, limits=c(0,15000))+
  #facet_wrap(~finescale_fishery_old+AREA, nrow=1)+
  facet_grid(finescale_fishery ~ area, space = "free") +
  guides(fill=guide_legend(title="iREC estimates")) +
  labs(title = paste0("Coverage by PFMA for Northern Strait of Georgia"),
       x = "Year", y = "Month") +
  theme_bw() + theme_minimal() + geom_vline(xintercept = 2013)+
  theme(legend.position="bottom",
        legend.box = "vertical",
        legend.box.just = "left")
g
```

\end{landscapepage}

## Revised Chinook catch estimates from 2005-2012

Where iREC is unavailable (before 2013), we predict iREC-incorporated seasonal catch estimates by finescale fishery using a modelled relationship between summertime creel estimates without iREC and seasonal iREC-incorporated catch estimates from 2013-2023. These seasonal estimates are then rolled up into yearly estimates. This process is automated and accomplished in the model function of the PacRecCatch R package.

### Splitting fisheries by season

Following the rules for incorporating iREC, we split previous fisheries in spring (months 1:4), summer (months 5:9) and fall (10:12) seasons. A few exceptions were made, for example WCVI ISBM doesn't have a spring fishery since no ISBM fisheries occur in the spring. We split fisheries by season in order to better pool estimates since there are not always iREC or creel estimates for each month. Terminal fisheries were not split since they typically are defined by limited time period for a given stock.

### Identifying a summer creel period

We identified a fishery specific consistently creeled or logbooked coverage period for the summer period where there is consistent data throughout the time series (from 2005 to 2023) from the creel + logbook data. The summer coverage period included all months within 7:8 that are consistent through the timeseries. This consistent chunk of data is then used to predict the estimated catch in the section of the time series where we don't have iREC. For South Coast regions this data is unfiltered South Coast creel + logbook catch estimates; for North and Central coast this data is referred to as "historical" but is logbook only for Central Coast and a combination of unfiltered Haida or Area 3/4 creel and logbook catch estimates in the North Coast.

### Modelling protocol

We investigated various models using a systematic approach:

 - Single model for southern BC fisheries and separate models for Northern and Central BC since the data inputs are different
 - Single model for spring and fall pre-terminal sport fisheries since these are iREC-only data

 - Single model for summer pre-terminal sport fisheries since these are iREC and creel combined data

 - Same data set tested for each model - therefore done without missing values

 - We didn't consider random effects models since we don't have enough levels of each factor to warrant random effects inclusion (need \>10 typically)

 - For all candidate models we used the `DHARMa` package to create a qq-plot to detect deviations in observations from expected distribution and a plot of the residuals against predicted values to detect patterns in residuals. We visually assessed whether candidate models improved plots.

 - We also compared candidate models using AIC, with a lower AIC indicating a better model fit.

The order of comparisons was as follows:

 - First we compared three distributions, normal (Gaussian), poisson, and Gamma, to see which fit our data the best on the full model. These distributions are all consistent with our positive, continuous data

$$
catch = creel.summer * status * finescale.fishery * season 
$$

-   Next, using the chosen distribution, we compared the full model with all terms to models with each of the terms dropped sequentially except for creel.summer which was our main interest. We did this first by dropping out full terms from the full interaction model, then used the dredge function in `MuMIn` to sequentially drop out the various sub-interactions

-   In each case, we selected the model with the lowest AIC and best visual diagnostics.

### Model validation with Salmon Head Recovery Program

We validated the modelling output with the Salmon Head Recovery Program (SHRP) by regressing both the observed catch (2013-2023) and the modelled catch (2005-2012) with heads recovered by the the sport head recovery program, which collects head submissions of marked Chinook for recovering CWT tags.  The slope of the linear regression between the kept mark catch and the number of heads across all CWT regions and areas should provide the average submission rate across all recreational fisheries.  As there was no substantial changes to the SHRP between the modelled catch period and the period iREC was used, there was support for the assumption that the slope of the linear regression between between the 2005 to 2012 period should generally be similar to the 2013 to 2023 period.

\clearpage

## Incorporation of both sets of revised estimates in bilateral PST processes

The Chinook Technical Committee (CTC) of the Pacific Salmon Commission (PSC) produces several annual analyses and reports. Notably, (1) the Catch and Escapement Report which details catch and escapement across all fisheries. (2) The Exploitation Rate Analysis and accompanying report which uses a cohort analysis on Coded Wire Tagged (CWT) hatchery stock to calculate Calendar Year Exploitation Rates on a stock-specific basis; and, (3) the Calibration Report, which documents the annual Chinook model calibration that utilizes output from the ERA and other sources.

The revised Chinook catch estimates from modelled data from 2005 to 2012 and from improved data from 2013-2023 were recently incorporated into a number of CTC processes starting in 2025. Notably, the total number of Kept and Released Chinook will be updated in the Annual Catch and Escapement Report. Next, catch estimates are used as inputs to the annual exploitation rate analysis (ERA) in two places. First, kept and marked catch estimates are used to expand Coded Wire Tag (CWT) observations from the Sport Head Recovery Program to CWT estimates uploaded to the Regional Mark Information System ([RMIS](https://www.rmpc.org/#:~:text=This%20data%20system%2C%20named%20the%20Regional%20Mark%20Information,Commission%E2%80%99s%20information%20needs%20under%20the%20Pacific%20Salmon%20Treaty.)) and ultimately used in the ERA analysis. Second, kept and released catch estimates are incorporated for most sport fisheries into the Chinook non-retention process in the ERA.

### Updating CWT estimates

Recreational fishery sampling of CWT in British Columbia is based on the collection of heads from marked Chinook and Coho from recreational fishers. These heads are obtained through numerous sources, including: general public submitting heads to [Salmon Head Recovery Program (SHRP) depots](https://search.open.canada.ca/openmap/3cc03bbf-d59f-4812-996e-ddc52e0ba99e) distributed coastwide at landing sites, marinas, and tackle shops, collected through creel surveyor interviews, and bio-sampling supported by avid anglers, guides, and lodges.

In order to estimate each recovered CWT to a total "estimated number", an estimated sample rate (aka "submission rate") is required; sample rate is estimated as the total heads submitted in a spatio-temporal stratum divided by the estimated marked kept catch in that stratum. These sample rates are corrected for lost tags that may occur during sampling processing when calculating the estimated number of the recovery.

Historically there have been various gaps and higher uncertainty in recreational catch estimates for periods and regions that typically have lower fishing effort. Various methods were used to estimate submission rates in these lower effort regions and time periods. The most common approach was to use the average submission rate of other regions and time periods with creel survey-based catch estimates as an indirect estimate for lower effort regions (e.g., summer submission rates used for winter recoveries). The implementation of the internet Recreational Effort and Catch program (iREC) provides complete representation of recreational catch in the Pacific Region (@irec_sar_2015). Using these iREC estimates, in combination with ongoing creel based estimates from high effort periods allows the direct estimation of submission rates for most strata. As discussed in @CYER2021, such a transition from indirect to direct methods will improve the accuracy of the resulting estimates.

Submission rates for recreational catch can vary for various reasons (e.g., the proportion of guided catch, the presence of creel surveyors, availability of head depots in an area, fisher awareness of and buy-in to the program). As submission rates may vary both spatially and temporally, Canada splits BC marine waters into smaller regions that may better represent different recreational fisher communities. To better align the CWT estimates with updated recreational catch estimates, Chinook CWT regions were redefined for 2005 to present (as shown in Figure \@ref(fig:fig-CwtMap)).


```{r cwtmap, echo=FALSE, message=FALSE, warning=FALSE, fig.height = 8}
#| label: fig-CwtMap
#| fig-cap: "CWT New area map"

bc_polygon <- read_sf("data/map/bc_polygon_simple.shp")
cwt_region <- read_sf("data/map/CWT_Region_simple.shp")
us_polygon <- read_sf("data/map/US_Polygon_5.shp")

#select only geometry column from both us and bc map
bc_polygon_geo <- bc_polygon %>%
  select(geometry)

us_polygon_geo <- us_polygon %>%
  select(geometry)

#transformiong us map to match up crs with canada map
us_polygon_geo <- st_transform(us_polygon_geo, st_crs(bc_polygon_geo))


combined_map <- rbind(bc_polygon_geo, us_polygon_geo)

#crop the map so it shows the bc coast
whole_coast_cropped <- st_crop(combined_map, 
                               xmin = -990416 , 
                               xmax = 1400416 ,
                               ymin = 299418, 
                               ymax = 1149418 )

#set pallete
num_regions <- length(unique(cwt_region$cwt_region))
palette <- RColorBrewer::brewer.pal(n = num_regions, name = "Set3")

cwt_region_centroids <- cwt_region %>%
  mutate(label_x = st_coordinates(st_centroid(geometry))[, 1],
         label_y = st_coordinates(st_centroid(geometry))[, 2]) %>%
  #move the label down and right a bit
  mutate(label_y_adjusted = label_y - 40000,
         label_x_adjusted = label_x + 40000)

#make the map
whole_bc_map_gg <- ggplot() +
  geom_sf(data = whole_coast_cropped, fill = "lightgreen", color = "black") +
  # Adjust borders of the land masses
  geom_sf(data = cwt_region, aes(fill = cwt_region), color = "black", size = 0.5) +
  # Set the color palette for cwt_region
  scale_fill_manual(values = palette, na.value = "white") +
  # Add labels
  geom_label(data = cwt_region_centroids, 
             aes(x = label_x_adjusted, 
                 y = label_y_adjusted, 
                 label = cwt_region),
             size = 3,
             fill = "white", 
             color = "black", 
             label.size = 0,  # No border around label
             check_overlap = TRUE) +
  # Add a theme
  theme_void() +
  theme(legend.position = "none",
        plot.margin = margin(0, 0, 0, 0)) 

whole_bc_map_gg

```   

In addition to redefining the spatial regions of CWT estimates, the temporal periods used for estimation were adjusted to align with the updated catch estimates. Similar to the catch seasonal periods, submission rates and resulting CWT estimates are based on the same seasonal periods: Spring (January to April), Summer (May to September), Fall (October to December). The exception is northern regions (e.g. Central BC and Northern BC) that are based on annual submission rates, as spring and fall fisheries are too small to separately estimate. 

In rare cases for certain strata, the combination of the marked catch estimate and submitted heads can lead to CWT estimates that are substantial outliers from most CWT estimates. Assuming that the underlying reason for the substantial outliers is more related to uncertainty in the marked clip catch estimate and not sudden substantial changes to the SHRP submission rate, various approaches to handle outliers have been developed; these are described in following sections. 

#### Changes to CWT Estimation Methods

As previously identified in this report, past recreational catch estimates had gaps in coverage that need to be revised and updated. Before this update to CWT estimation methods, there were regions and time periods that had no marked catch estimates or had inconsistencies between the number of recoveries and estimated marked catch (e.g. more samples than marked catch). To handle these issues, CWT estimates were based on several indirect methods. Indirect methods included using the average submission rate of the same region from other months (e.g. Strait of Georgia summer submission rates for winter months), the average of the submission rates in other regions (e.g. Southern BC submission rates for Central BC), or assumed maximum and minimum submission rates applied when estimated submission rates were unreasonably high or low, presumably resulting from uncertainty in the marked kept catch estimates.

Although the updated recreational catch provides complete coverage, approximately 2.5% of observed CWT recoveries are associated with regions and time periods with an estimated marked catch of zero or result in extreme submission rates (i.e., less than 2% or greater than 40%). Most of these recoveries are associated with years before iREC (before 2013) when we rely on modelled catch. We developed updated and standardized algorithms to our indirect catch estimation methods leveraging the more extensive coverage of recreational catch estimates.

The updated indirect methods can be grouped in three different categories based on the approach used to compute each method, as well as the CWT area and season for which the estimate was produced. 

**Method 1:** When a time period (i.e., season) within a region has an outlier submission rate ($s$), the first option is to use an annual average of all the time periods (i) within the region weighted by the number of heads ($h$) in each period using the equation below. This should weight the annual average submission rate ($\bar{s}$) used for the outlier period to a rate that has the lowest uncertainty, based on the assumption that periods with the lowest uncertainty will have the highest number of heads contributed to the program (Equation \eqref{eq:cwt_wght_avg}).

$$
\bar{s} = \frac{\sigma_i h_i s_i}{\sigma_i h_i}
\label{eq:cwt_wght_avg}
$$

**Method 2:** In some circumstances, the annual average submission rate may result in an outlier estimate. This typically occurs in the Strait of Georgia with catch estimate before iREC reporting (i.e. before 2013). To better represent the submission rate of these regions and years, a weighted average is used based on the annual submission rates 2 years before and 2 years after the outlier year. The moving window average should better represent average submission rate of fishers in a region, as the knowledge and implementation of the SHRP is not expected to vary substantially across years within a region (e.g. head depots operations are generally consistent).

**Method 3:** When there are annual gaps in adipose clipped catch, such as in the Prince Rupert region from 2005 to 2007, the weighted annual average for the northern portion of BC (including Haida Gwaii and Central BC) was used based on Equation \eqref{eq:cwt_wght_avg}. This will weight the average submission rate to regions and time periods with the most effort.

### Updating Chinook non-retention (release) estimates

In 2025, in an attempt to account for mark-selective fisheries, the ERA conducted by the CTC switched from a model that only accounts Chinook non-retention without selectively to a model that supports mark selective regulation. Therefore, the applicable rates in the ERA that are affected by the revised catch estimates are the marked released rate ($MRR$) and unmarked kept rate ($UKR$) (details provided in @CYER2024). In a given PFMA and month, MRR and UKR are calculated as follows:

$MRR = marked.released / (marked.released + marked.kept)$

$UKR = unmarked.kept / (unmarked.kept + unmarked.released)$

We calculated the $MRR$ and $UKR$ at the PFMA and month level and then used a weighted average based on total catch estimate per area and month to generate a finescale fishery specific $MRR$ and $UKR$.  Within the CTC ERA, these finescale fishery $MRR$ and $UKR$ values are combined into a ERA fishery value based on a cohort specific weighted average of each value.

With the exception of Juan de Fuca, which did have mark-selective fisheries before 2012, all other sport fisheries were non-selective before 2013. Since the data is modelled, we did not want to bias the previous non-selective fisheries by allowing for selectivity, therefore we have fixed the MRR and URR rates to be equal in the modelled data, by calculating a single release rate for marked and unmarked fish combined. After 2013, the data is observed and therefore allowed to vary mark selectivity even if no specific mark selective regulations were imposed. Terminal fisheries typically happen in the summer period, therefore they were assigned the same MRR and UKR rates as the equivalent summer fishery.
